{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/home/zoro/Projects/for-you/screens/MessagingScreen.js\",\n  _this = this;\nimport React, { useEffect, useLayoutEffect, useState } from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport Pressable from \"react-native-web/dist/exports/Pressable\";\nimport socket from \"../utils/socket\";\nimport { styles } from \"../utils/styles\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport MessageComponent from \"../components/Message\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar Messaging = function Messaging(_ref) {\n  var route = _ref.route,\n    navigation = _ref.navigation;\n  var _useState = useState(\"\"),\n    _useState2 = _slicedToArray(_useState, 2),\n    user = _useState2[0],\n    setUser = _useState2[1];\n  var _route$params = route.params,\n    name = _route$params.name,\n    id = _route$params.id;\n  var _useState3 = useState([]),\n    _useState4 = _slicedToArray(_useState3, 2),\n    chatMessages = _useState4[0],\n    setChatMessages = _useState4[1];\n  var _useState5 = useState(\"\"),\n    _useState6 = _slicedToArray(_useState5, 2),\n    message = _useState6[0],\n    setMessage = _useState6[1];\n  var getUsername = function () {\n    var _ref2 = _asyncToGenerator(function* () {\n      try {\n        var value = yield AsyncStorage.getItem(\"username\");\n        if (value !== null) {\n          setUser(value);\n        }\n      } catch (e) {\n        console.error(\"Error while loading username!\");\n      }\n    });\n    return function getUsername() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  var handleNewMessage = function handleNewMessage() {\n    var hour = new Date().getHours() < 10 ? `0${new Date().getHours()}` : `${new Date().getHours()}`;\n    var mins = new Date().getMinutes() < 10 ? `0${new Date().getMinutes()}` : `${new Date().getMinutes()}`;\n    if (user) {\n      socket.emit(\"newMessage\", {\n        message: message,\n        room_id: id,\n        user: user,\n        timestamp: {\n          hour: hour,\n          mins: mins\n        }\n      });\n    }\n  };\n  useLayoutEffect(function () {\n    navigation.setOptions({\n      title: name\n    });\n    getUsername();\n    socket.emit(\"findRoom\", id);\n    socket.on(\"foundRoom\", function (roomChats) {\n      return setChatMessages(roomChats);\n    });\n  }, []);\n  useEffect(function () {\n    socket.on(\"foundRoom\", function (roomChats) {\n      return setChatMessages(roomChats);\n    });\n  }, [socket]);\n  return _jsxDEV(View, {\n    style: styles.messagingscreen,\n    children: [_jsxDEV(View, {\n      style: [styles.messagingscreen, {\n        paddingVertical: 15,\n        paddingHorizontal: 10\n      }],\n      children: chatMessages[0] ? _jsxDEV(FlatList, {\n        data: chatMessages,\n        renderItem: function renderItem(_ref3) {\n          var item = _ref3.item;\n          return _jsxDEV(MessageComponent, {\n            item: item,\n            user: user\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 70,\n            columnNumber: 8\n          }, _this);\n        },\n        keyExtractor: function keyExtractor(item) {\n          return item.id;\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 6\n      }, _this) : \"\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 4\n    }, _this), _jsxDEV(View, {\n      style: styles.messaginginputContainer,\n      children: [_jsxDEV(TextInput, {\n        style: styles.messaginginput,\n        onChangeText: function onChangeText(value) {\n          return setMessage(value);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 5\n      }, _this), _jsxDEV(Pressable, {\n        style: styles.messagingbuttonContainer,\n        onPress: handleNewMessage,\n        children: _jsxDEV(View, {\n          children: _jsxDEV(Text, {\n            style: {\n              color: \"#f2f0f1\",\n              fontSize: 20\n            },\n            children: \"SEND\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 89,\n            columnNumber: 7\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 6\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 5\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 4\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 59,\n    columnNumber: 3\n  }, _this);\n};\nexport default Messaging;","map":{"version":3,"names":["React","useEffect","useLayoutEffect","useState","View","TextInput","Text","FlatList","Pressable","socket","styles","AsyncStorage","MessageComponent","jsxDEV","_jsxDEV","Messaging","_ref","route","navigation","_useState","_useState2","_slicedToArray","user","setUser","_route$params","params","name","id","_useState3","_useState4","chatMessages","setChatMessages","_useState5","_useState6","message","setMessage","getUsername","_ref2","_asyncToGenerator","value","getItem","e","console","error","apply","arguments","handleNewMessage","hour","Date","getHours","mins","getMinutes","emit","room_id","timestamp","setOptions","title","on","roomChats","style","messagingscreen","children","paddingVertical","paddingHorizontal","data","renderItem","_ref3","item","fileName","_jsxFileName","lineNumber","columnNumber","_this","keyExtractor","messaginginputContainer","messaginginput","onChangeText","messagingbuttonContainer","onPress","color","fontSize"],"sources":["/home/zoro/Projects/for-you/screens/MessagingScreen.js"],"sourcesContent":["import React, { useEffect, useLayoutEffect, useState } from \"react\";\nimport { View, TextInput, Text, FlatList, Pressable } from \"react-native\";\nimport socket from \"../utils/socket\";\nimport { styles } from \"../utils/styles\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport MessageComponent from \"../components/Message\";\n\nconst Messaging = ({ route, navigation }) => {\n\tconst [user, setUser] = useState(\"\");\n\tconst { name, id } = route.params;\n\n\tconst [chatMessages, setChatMessages] = useState([]);\n\tconst [message, setMessage] = useState(\"\");\n\n\tconst getUsername = async () => {\n\t\ttry {\n\t\t\tconst value = await AsyncStorage.getItem(\"username\");\n\t\t\tif (value !== null) {\n\t\t\t\tsetUser(value);\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.error(\"Error while loading username!\");\n\t\t}\n\t};\n\n\tconst handleNewMessage = () => {\n\t\tconst hour =\n\t\t\tnew Date().getHours() < 10\n\t\t\t\t? `0${new Date().getHours()}`\n\t\t\t\t: `${new Date().getHours()}`;\n\n\t\tconst mins =\n\t\t\tnew Date().getMinutes() < 10\n\t\t\t\t? `0${new Date().getMinutes()}`\n\t\t\t\t: `${new Date().getMinutes()}`;\n\n\t\tif (user) {\n\t\t\tsocket.emit(\"newMessage\", {\n\t\t\t\tmessage,\n\t\t\t\troom_id: id,\n\t\t\t\tuser,\n\t\t\t\ttimestamp: { hour, mins },\n\t\t\t});\n\t\t}\n\t};\n\n\tuseLayoutEffect(() => {\n\t\tnavigation.setOptions({ title: name });\n\t\tgetUsername();\n\t\tsocket.emit(\"findRoom\", id);\n\t\tsocket.on(\"foundRoom\", (roomChats) => setChatMessages(roomChats));\n\t}, []);\n\n\tuseEffect(() => {\n\t\tsocket.on(\"foundRoom\", (roomChats) => setChatMessages(roomChats));\n\t}, [socket]);\n\n\treturn (\n\t\t<View style={styles.messagingscreen}>\n\t\t\t<View\n\t\t\t\tstyle={[\n\t\t\t\t\tstyles.messagingscreen,\n\t\t\t\t\t{ paddingVertical: 15, paddingHorizontal: 10 },\n\t\t\t\t]}\n\t\t\t>\n\t\t\t\t{chatMessages[0] ? (\n\t\t\t\t\t<FlatList\n\t\t\t\t\t\tdata={chatMessages}\n\t\t\t\t\t\trenderItem={({ item }) => (\n\t\t\t\t\t\t\t<MessageComponent item={item} user={user} />\n\t\t\t\t\t\t)}\n\t\t\t\t\t\tkeyExtractor={(item) => item.id}\n\t\t\t\t\t/>\n\t\t\t\t) : (\n\t\t\t\t\t\"\"\n\t\t\t\t)}\n\t\t\t</View>\n\n\t\t\t<View style={styles.messaginginputContainer}>\n\t\t\t\t<TextInput\n\t\t\t\t\tstyle={styles.messaginginput}\n\t\t\t\t\tonChangeText={(value) => setMessage(value)}\n\t\t\t\t/>\n\t\t\t\t<Pressable\n\t\t\t\t\tstyle={styles.messagingbuttonContainer}\n\t\t\t\t\tonPress={handleNewMessage}\n\t\t\t\t>\n\t\t\t\t\t<View>\n\t\t\t\t\t\t<Text style={{ color: \"#f2f0f1\", fontSize: 20 }}>SEND</Text>\n\t\t\t\t\t</View>\n\t\t\t\t</Pressable>\n\t\t\t</View>\n\t\t</View>\n\t);\n};\n\nexport default Messaging;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}